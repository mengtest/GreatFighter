## 战斗系统

### 规则
* 对阵组成：3V3
	* 参考了《王牌英雄》的对阵组成，选择3V3是因为在两条路的情况下，拥有第三个人，就拥有了多样化的战术，形成了**策略性**。
* 胜利条件：一般情况下，胜利条件为摧毁敌方基地。特殊情况下，请参考[时间机制]的内容。
	* 失败条件即反之亦然。
	* 参考了MOBA游戏的经典设计，同时加入了《皇室战争》的设计以控制游戏时间。
* 时间机制
	* 士兵诞生时间：10秒（参考[单位-种类-士兵]）
	* 野怪诞生时间：15秒（参考[单位-种类-野怪]）
	* 回复球诞生时间：30秒（参考[设施-种类-回复球]）
	* 标准游戏时间：5分钟
		* 参考了《皇室战争》的标准时间，不过并未采用《皇室战争》的3分钟方案，因为我认为本游戏的游戏内容可以使游戏时间增长，且MOBA类游戏需要付出奔波成本（到处移动），理应增长。
	* 开启暴走阶段：4分钟后
		* 参考了《皇室战争》的**双倍圣水时间**，一样是于游戏最后一分钟时开启。
		* 和双倍圣水时间不同，暴走阶段的效果为：
			* 士兵和野怪的刷新时间减少。
			* 所有英雄获得一定的冷却缩减。
	* 开启终结阶段：5分钟后
		* 参考了《皇室战争》的**突然死亡模式**，一样是于游戏标准时间过后时开启。
		* 与突然死亡模式类似，终结阶段在继承了暴走阶段的内容的基础上，加入了以下效果：
			* 摧毁敌方一座塔便获得胜利，反之亦然。
	* 其他相关内容，请查阅：
		* [单位-种类-士兵]
		* [单位-种类-野怪]
		* [设施-种类-传送阵]
		* [设施-种类-回复球]
	* 看起来相关内容里具有刷新时间的设定，这是为什么？
		* 对于传统MOBA来说，具有首次刷新时间的设计，是为了给予玩家充足的购买道具、赶往前线，以及展开1级团的机会。
		* 我们虽然无需进行购买道具，赶往前线也不需要花多少时间，但还是要照顾一些状态不太好的玩家（让他们适应操作、结束多余的进程之类），以及这确实是触发早期冲突的好方案。

### 地图
* 地图即游戏战斗的场所，分为上下两层。
* 显示层次：地图的显示层次分为两层，依顺序分别是：
	* 底层：底层位于中间层之下，一般表现为地图背景和地表。
	* 对象层：中间层的内容为**对象**。
* 布局
	* ![map](https://raw.githubusercontent.com/Manistein/Photos/master/IndenpentProject/GreatFighter/战斗系统/地图草图.png)
	* 具体构成元素内容，请查阅[单位]和[设施]
* 疑难解答
	* 为什么只做1条塔路？
		* 鉴于游戏时长的安排，我认为只适合做1条塔路。如果做2条的话，只能选择让塔变成脆纸且不适合再追加更多的内容，这样游戏内容便颇为单调了。
		* 况且从《王牌英雄》的情况来看，想要设计2塔路1基地的话，地图的复杂度将会剧增，且我们的素材决定小兵不太适合做跳跃之类的空中移动行为。
		* 但塔路的模式也并非先例，在《王牌英雄》的新模式及《超时空对决》都有着单塔路的设计。
	* 为什么设计为2塔1基地？
		* 我认为这是个很自然且合理的设计，况且在《王牌英雄》和《超时空对决》里也是这么做的。
		* 如果只是1塔1基地的设定，滚雪球的效应将会扩大，玩家在塔被摧毁后很可能便会放弃游戏。
	* 为什么要做一个专门是野区的上层？
		* 因为无论是单纯的单塔路或双塔路，都略显单调。而上层野区的设计，则让游戏增色不少。玩家能够通过击杀野怪来获得帮助推进胜利的增益，乃至阻止甚至吞噬属于敌方的野怪，从而压制敌方。
		* 因为野区成为兵家必争之地，而队伍成员为3人，如何安排人手则成为了重中之重。这样便体现了策略性。
		* 以及还可以通过野区绕到敌方后方，进行突袭/斩首行动。所以我认为这个上层野区的设计，是本草案的精华所在。
	* 没有泉水和商店？
		* 不需要商店是因为本游戏的养成系统采用了《皇室战争》，加之在这短暂的游戏时间里，商店和经济系统的存在本就鸡肋无比。
		* 至于泉水，在传统MOBA设计里，泉水本就是和商店一体的存在。今商店不存，我便不是很想做泉水了（还得配个回城技能），于是便让回复球代替之。
		* 不过没了泉水后的弊端，便是在基地保卫战时无法依赖泉水进行二度作战，以及不如泉水稳定（回复球属于有限资源）。如此便凸显了回复及吸血类技能的重要性了。

### 对象
* 对象是在地图上活跃的存在，有多种具体表现形式。
* 动画机制
	* 对象的画面表现即是动画，动画的形式包括帧动画和粒子动画，且允许多个动画的存在（纸娃娃）。
* 运动机制
	* 对象可以进行画面表现方面的运动，包括但不限于位移、缩放、旋转等。
* 排序机制
	* 对象之间存在一个排序规则以决定画面显示的先后，这个规则**暂未决定**。
* 碰撞判定机制
	* 对象有与其他对象进行碰撞交互的需要，所以需要决定一个或一组的碰撞盒，这些碰撞盒由动画精灵形成。
* 攻击机制
	* 攻击机制即对目标单位进行攻击判定与伤害结算，并将以**战斗表现**的形式体现。
	* 注意：并非只有单位才能对单位进行攻击，而是**对象对单位**进行攻击。
	* 攻击判定分为三部分：
		* 身份判定：目标单位是否符合攻击条件，如某攻击并不会攻击同阵营单位。
		* 开关判定：判断目标单位是否已经攻击过了。
		* 碰撞判定：使用对象的某些碰撞盒去与目标单位进行碰撞判定。
	* 攻击判定通过之后，便会根据公式进行伤害结算，并触发战斗表现，具体请查看[种类-单位-属性机制]和[种类-单位-战斗表现]。
* 阻拦机制
	* 阻拦机制即不允许某些**符合条件**内的对象进行位移通过，但并非通过碰撞盒进行判定，而是采用**坐标**。
	* 阻拦条件最常见的形式便是敌对阵营的单位。
	* 注意：这不是一个必须开启的机制，只是在某些对象某些场合下会用到。
* 种类
	* 设施
		* 设施是一种可被英雄碰撞触发的对象，无阵营限制。
		* 种类
			* 回复球
				* **受伤且无回复球BUFF**的英雄触碰后会获得一个**不断回复生命值的BUFF**，然后消失，每隔*20秒*刷新，首次刷新时间为*30秒*。
				* 为什么设置首次刷新时间与刷新时间为这样的数值？
					* 首次刷新时间为30秒，是因为这是一个第一波战斗已经打响后的时间，可以使早期参团负伤的玩家必须喘息一下，这也算是一种平衡设计（对于早期死去的敌方玩家而言）。
					* 每隔20秒刷新一次，是感觉小于20秒则过于频繁，那么就变得不平衡了。大于20秒则变得作用不大了，玩家会选择死亡以进行更“有效率”的回复。
				* 为什么是不断回复生命值的BUFF而非一瞬间回复？
					* 如果是一瞬间回复的话，太少则像《王者荣耀》的那样作用甚微，太多则成为不平衡点。故选择为持续回复，也可代替泉水的作用。
			* 传送阵
				* 玩家可以站在传送阵范围内按下某键开始传送仪式，将会站立并进行读条*3秒*，此时若非**站立状态**则会打断仪式，读条完毕后便会传送到另一端对应的传送阵。反之亦然，所以这是一个双向传送阵。
				* 传送完毕后会有一个*0.5秒*内的**无敌BUFF**。
				* 传送阵有哪些好处？
					* 使用传送阵的话，可以说上下层实际上就是独立的地图，并不需要实现那种传统竖版的踏板机制，在制作难度上低了很多。
					* 使用传送阵还会让地图布局节点很多，毕竟踏板的布置并不是那么的容易。
					* 使用传送阵便不需要担心野怪的跨界处理。
					* 使用传送阵还使得操作难度有所降低。
				* 为何设置为读条3秒，无敌BUFF0.5秒？
					* 读条时间为3秒我认为是个很适合的数值，因为在动作游戏里，战斗节奏是十分快的，所以不能采用类似《英雄联盟》的传送读条设计。
					* 无敌BUFF的设计是很有必要的，因为有可能出现传送后的玩家出现掉帧从而影响操作的可能，所以设置0.5秒作为缓冲。
	* 特效
		* 特效通常表现为播放一段动画然后消失的对象，但也可以应用**攻击机制**变成攻击特效以及应用**运动机制**变成子弹特效等。
	* 单位
		* 单位是一种会参与战斗且可被摧毁（杀死）的对象。
		* 状态机制
			* 单位拥有状态，将由一个状态机进行管理运作。
			* 单位拥有以下状态，且它们的关系如下图：![statemachine](https://raw.githubusercontent.com/Manistein/Photos/master/IndenpentProject/GreatFighter/战斗系统/状态机.png)
		* 属性机制
			* 单位拥有许多属性，它们在战斗时将会用到，分别有以下属性：
				* 生命值：单位存活的保证，当单位被攻击时将会损失生命值，如果生命值为0则死亡。
				* 攻击力：单位攻击时所需，攻击力会影响伤害的结果，它们将会和防御力作用决定最终伤害。
				* 防御力：单位被攻击时所需，防御力会影响伤害的结果，它们将会和攻击力作用决定最终伤害。
				* 暴击率：攻击时触发暴击的概率值，以百分比表示。
				* 移动速度：决定单位移动速度的数值，将经过一定换算得出实际的数值。
				* 攻击速度：决定单位攻击动作的数值，将经过一定换算得出实际的数值。
		* AI机制
			* AI决定单位与敌方战斗的行为，主要具有几个属性：
				* 巡视范围：以一条水平向量的形式体现，即左右范围。
				* 攻击范围：以矩形的形式体现，若敌方单位处于矩形内，则表示可以进行攻击。
			* 以及具有以下行为：
				* 检索仇恨目标：检索巡视范围内的敌方单位，决定了一名敌方单位后将会视为仇恨目标，会采取向其移动的行为。每隔一段时间会重新进行。**注意：这并非必须的。**
				* 扫描敌人：每隔一段时间，将会使用攻击范围矩形扫描是否存在敌方单位，若存在，则发动对应的攻击。
		* BUFF机制
			* BUFF是一种依附于单位的事件，一般结束条件为维持一段时间。
			* BUFF的体现形式一般以附在单位上的特效，以及在UI上的图标。
			* BUFF的种类有很多，最典型的例如出血、冰冻、属性增幅等。
		* 技能机制
			* 技能可以理解为单位的战斗行为细分，每一个具体战斗行为（如多段连砍）基本上都是由多个技能所组成的。
		* 读条机制
			* 单位在某些时候会进行读条，一般是为了达成某个行为所做的等待。读条一般会与状态挂钩（离开状态则读条取消），当然这不是一定的。
			* 读条的表现一般只会是玩家控制的单位才能看到，表现为类似这样上字下条的UI形式![recall](https://raw.githubusercontent.com/Manistein/Photos/master/IndenpentProject/GreatFighter/战斗系统/读条.png)
			* UI位置一般处于画面中下方，所以只能看到玩家控制的单位的读条情况，其他单位是看不到的。
		* 攻击类型
			* 单体攻击：表现为击中一个敌人后便会结束，忽略其他敌人。
			* 群体攻击：表现为攻击范围内所有敌人。
		* 所属
			* 阵营：阵营单位即属于阵营，且双方阵营皆有的单位，表现为以另一阵营为敌且不可被友方阵营单位攻击。
			* 公共：公共单位无阵营限制，会与双方阵营为敌且可攻击双方阵营单位，不过不会与公共单位为敌。
		* 种类
			* 基地
				* 基地属于**阵营单位**，不可穿过（只是处于不可行走区域导致不可穿过，非单位本身的性质）。
				* 基地负责生产士兵，每隔一段时间生成一组。
				* 基地需要塔全灭后方可被攻击。
				* 基地是阵营的核心，若基地被摧毁，则视为游戏失败。
				* 在基地一定范围内的我方单位会获得防御力加成。
				* 为什么不设定基地拥有攻击能力？
					* 这也是个可选项，不过我比较担心这将使得游戏时间延长，还是根据情况来看。
				* 既然基地没有攻击能力，岂不是代表塔被摧毁后便可放弃游戏了？
					* 从地图设计来看，是允许劣势方从上层绕到对方塔下的，如此便可进行斩首行动。
			* 塔
				* 塔属于**阵营单位**。
				* 塔负责攻击最近的敌人，攻击类型为**单体攻击**。
				* 在塔一定范围内的我方单位会获得防御力加成。
				* 为什么是单体攻击且允许敌方通过？那岂非越塔强杀变得很容易？
					* 这种情况请参考《王牌英雄》的塔攻击伤害，在这种情况下，越塔强杀可不是那么容易的一件事，这需要队友不断交替抵挡伤害，很有操作要求。
					* 况且在塔下的我方单位还会获得防御力加成，这个设计是出自《英雄联盟》的，事实证明这是个塔下反杀的利器。
					* 至于允许敌方通过，结合上面的回答，就无须解释了。
				* 既然塔的伤害很高，那小兵岂不是很肉？
					* 没错，所以小兵自有小兵摩。英雄绝非打小兵的主力，只是推动者。这种理念正是出自《王牌英雄》，我认为很成功。
				* 为什么并没有设计内塔保护？就是必须先摧毁外塔才可摧毁内塔。
					* 因为这可以结合从上层绕敌深处的设计，也可以推动游戏节奏，衍生更多的战术。
					* 虽然我感觉这的确可能会成为一个不平衡点，不过目前这样更有趣，等具体情况再看吧。
			* 士兵
				* 士兵属于**阵营单位**，从基地诞生，目标为前往敌方阵营。
				* 士兵负责攻击面前的敌人。
				* 士兵每隔*15秒*便会从基地诞生1组，1组基础内容为**3名近战兵**（特殊条件下会追加远程兵）。并非一次性诞生1组士兵，而是每隔*2秒*诞生1名。
				* 士兵到达前线大致需要*15秒*。
				* 士兵的首次刷新时间为*10秒*。
				* 士兵包括两种类型：
					* 近战兵
						* 基础类型，最普通的士兵。
						* 攻击方式为近战，类型为**单体攻击**。
					* 远程兵
						* 高级类型，需要通过特殊条件才会生成。
						* 攻击方式为远程，类型为**群体攻击**。
				* 士兵的时间设置有何用意？
					* 首次刷新时间为10秒，到达前线时间大致为15秒，这个时间足以让玩家做好开战的准备，甚至触发了早期冲突了。
					* 每隔2秒诞生1名的设计，是不想让士兵直接就黏在一块，这样子都展现不出究竟有多少名了（做不同外形的士兵是个好主意）。
					* 刷新时间为15秒，到达前线时间大致为15秒，我认为30秒一波兵是一个很舒服的设计。（与《王者荣耀》的刷新时间相同）
				* 士兵既然允许敌方通过，那么敌方绕后攻击小兵的话，小兵是否会转身攻击？
					* 不会，小兵没有仇恨系统，它的移动目标只是前方，以及攻击面前的敌人而已。
				* 为何不采用《英雄联盟》和《王牌英雄》那样的随时间升级小兵设计？
					* 我们的游戏时间太短了，用不着这种设计。况且也有了暴走、终结阶段，这剂药可比它们的设计要猛多了。
			* 野怪
				* 野怪属于**公共单位**，首次刷新时间为*15秒*，被消灭*30秒*后刷新。
				* 野怪会追逐并攻击目标，但远离老巢一定距离便会返回且急速回复，攻击类型为群体攻击。
				* 击杀野怪后便会获得1次生成远程兵的机会，将于下次生成士兵时出现。
				* 在尚未生成士兵之前便击杀了2次野怪，将如何算？
					* 每次生成士兵时，只会结算1次，所以会接下来的2次生成士兵都会有远程兵，以此类推。
					* 野怪很难打吗？
						* 不会，1名英雄即可对付，只是需要一定的时间（参考《王者荣耀》的打野时间），所以有可能会被敌方争夺。
				* 为什么是群体攻击？
					* 因为这是对双方阵营一视同仁的公平（不会因为某玩家因被野怪盯上只会攻击他一个而导致的极端不平衡）。
			* 大野怪
				* 大野怪属于**公共单位**，需要所有野怪死亡后方会出现。
				* 大野怪只会攻击最近的敌人（不会追逐），攻击手法多样化（远近皆有），攻击类型为单体攻击。
				* 当*5秒*内未没触发战斗时，大野怪将急速回复。
				* 击杀大野怪后会获得一个强力的BUFF：对塔和基地造成的伤害增加*30%*，持续*45秒*，被击杀BUFF会转移到击杀者上（类似《英雄联盟》的红蓝BUFF设计），如果击杀者本身持有此BUFF，则变为剩余时间取两者最大。
				* 为什么大野怪要设置在地图中间且需要所有野怪死亡后方才出现？
					* 这种设计的含义不言而喻，便是逼迫双方对其进行争夺，如同《英雄联盟》的纳什男爵争夺战一般。
					* 设计为需要所有野怪死亡后方才出现，为的便是让这种争夺是有成本和铺垫的。
				* 为什么BUFF是“对塔和基地造成的伤害增加30%，持续45秒”且被击杀后会转移？
					* 设计为对塔和基地加伤，是因为这游戏本质上就是个**推塔游戏**，这便是最佳的馈赠，30%的数值非常适中，不至于产生压倒性的后果。
					* 至于被击杀后会转移，为的是避免滚雪球的问题，同时也使得持有BUFF者成为众矢之的。
					* 持续45秒，是理论上最快下一次获得BUFF的时间，以及这个时间很适合作为可转移的BUFF，又不至于太长过多影响平衡性。
				* 大野怪的难度如何？
					* 较难，因为血较厚，也许需要2名英雄合力战斗与轮流分担伤害（所以才是单体伤害）。当然这里的2名英雄包括敌方，这一定很有趣。