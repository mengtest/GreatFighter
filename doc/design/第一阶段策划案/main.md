## 第一阶段策划案

* 主题目标
	* 本阶段的目标为实现两名玩家在一张地图上对战。
* 游戏规则
	* 两名玩家经过匹配后，共同进入一张地图展开对战，相互为敌对关系。
	* 游戏的胜利条件为击败对手，或者对手退出了游戏。反之亦然。
	* 当结算了胜利/失败之后，便会退出到上一级界面。届时玩家可继续进行匹配进行下一场对战。
* 地图
	* 地图即游戏战斗的场所，在本阶段只有一张。
	* 显示层次
		* 地图的显示层次分为两层，依顺序分别是：
			* 底层：一般表现为地图背景和地表。
			* 对象层：对象显示所在的层次。
	* 活动范围
		* 地图拥有一定的活动范围，对象的运动只能在范围内进行。
		* 每张地图都需要编辑活动范围的左右边界。
* 对象
	* 对象是在地图上活跃的存在，有多种具体表现形式。
	* 朝向
		* 朝向决定了动画的翻转乃至运动的方向，它拥有两个值：左(-1)和右(1)。
		* 默认朝向为右。
	* 动画
		* 动画决定了对象的画面表现，这里的动画指的是帧动画。
		* 一个对象允许拥有多个动画，这样便形成了纸娃娃系统。
	* 阴影
		* 阴影对于对象而言是一个可选项，也就是说，有的对象是不会显示阴影的。
		* 阴影的表现方式目前有两套方案：于对象的坐标原点处显示黑色圆圈或根据动画计算出的斜影。
	* 运动
		* 对象可以进行画面表现方面的运动，包括但不限于位移、缩放、旋转等。
		* 位移运动需要在地图活动范围之内进行。
	* 排序
		* 对象之间存在一个排序规则以决定画面显示的先后，这个规则**暂未决定**。
	* 碰撞判定
		* 对象有与其他对象进行碰撞交互的需要，所以需要决定一组的碰撞盒，这些碰撞盒由动画精灵形成。
	* 发起攻击
		* 对象可以向其他*单位*发起攻击，发起一次攻击需要提供如下信息：
			* 攻击方的诸多信息
				* 因为发起攻击是攻击方与被攻击方的一次交互，所以可能涉及许多复杂的扩展操作，故此项需要根据业务需要来进行调整。
			* 攻击碰撞盒
				* 攻击判定所需，与此同时被攻击方也需提供被攻击碰撞盒。
			* 面向阵营
				* 攻击所面向的阵营，它拥有三个值：全部、红方、蓝方。
			* 攻击类型
				* 攻击类型分为两种：单体和群体。
				* 单体攻击表现为击中一个目标后便会结束，群体攻击则不然。
			* 伤害值
				* 这里的伤害值已经是经过结算（结合暴击率、攻击力），可直接与被攻击方的防御力进行结算出最终伤害了。
				* 所以这一数值一般是先提供基本的伤害百分比，然后在攻击判定达成后进行计算成值。
			* 攻击判断条件
				* 一般以bool函数的形式体现，属扩展功能。
			* 攻击后事件
				* 一般以void函数的形式体现，拥有是否达成攻击的参数。属扩展功能。
		* 攻击结算的流程：
			* 对所有单位进行轮询。
			* 判定单位是否已攻击过。
			* 判定是否符合*面向阵营*。
			* 判定*碰撞判定*是否达成。
			* 判定*攻击判断条件*是否达成。
			* 结算*伤害值*。
			* 触发攻击。
			* 触发*攻击后事件*。
			* 判定攻击类型，决定下一个单位的处理。
	* 种类
		* 特效
			* 特效通常表现为播放一段动画然后消失的对象，可以应用*发起攻击*变成攻击特效以及应用*运动*变成子弹特效等。
			* 绑定对象
				* 特效一般会绑定某个对象，做出诸如跟随对象的运动、与对象的动画同步之类的行为。
		* 单位
			* 单位是一种会参与战斗且可被摧毁（杀死）的对象。
			* 血条
				* 单位除与其他对象一样拥有一组动画之外，还会于动画顶部（自定义的一个高度值）显示血条。
			* 状态
				* 单位拥有状态，将由一个状态机进行管理运作。
				* 单位拥有以下状态，且它们的关系如下图：![statemachine](https://raw.githubusercontent.com/Manistein/Photos/master/IndenpentProject/GreatFighter/战斗系统/状态机.png)
			* 属性
				* 单位拥有许多属性，它们在战斗时将会用到，分别有以下属性：
					* 生命值：单位存活的保证，当单位被攻击时将会损失生命值，如果生命值为0则死亡。
					* 攻击力：单位攻击时所需，攻击力会影响伤害的结果，它们将会和防御力作用决定最终伤害。
					* 防御力：单位被攻击时所需，防御力会影响伤害的结果，它们将会和攻击力作用决定最终伤害。
					* 暴击率：攻击时触发暴击的概率值，以百分比表示。
					* 移动速度：决定单位移动速度的数值，将经过一定换算得出实际的数值。
					* 攻击速度：决定单位攻击动作的数值，将经过一定换算得出实际的数值。
			* 技能
				* 技能可以理解为单位的战斗行为细分，每一个具体战斗行为（如多段连砍）基本上都是由多个技能所组成的。
				* 使用技能后便会进入攻击（attack）状态，结束后恢复站立（stand）状态。
			* 阵营
				* 单位拥有阵营，分为野怪、红方、蓝方。
				* 阵营决定了被攻击时的阵营判定，不过这和发起攻击时提供的面向阵营参数无关。
			* 被攻击
				* 单位允许被攻击，会遭受来自其他（包括自身）对象的攻击，被攻击后会扣损生命值，至0则死亡。
				* 想要被攻击，首先要通过之前的种种判定，且到达被攻击阶段后，也可通过对象自身的被攻击判定函数进行否决攻击。
				* 如果攻击判定完全通过，则会根据提供的伤害值与单位的防御值进行结算出最终伤害，并扣损生命值，触发被攻击的事件，并判定是否死亡。
				* 关于被攻击的表现，详见[被攻击表现.md]。
			* 种类
				* 英雄
					* 英雄即玩家所控制的单位，受其他系统所影响。
					* 显示名称
						* 英雄比之传统单位，还会在血条上方显示玩家的游戏昵称作为识别。
					* 玩家控制
						* 英雄的控制需要通过UI层的控件下达指令。
						* 玩家可对英雄进行的控制操作包括左右移动和使用技能。
					* 镜头跟随
						* 镜头会跟随玩家所操控的英雄的**X坐标**，Y坐标则为地图中间。
					* 种类
						* 鬼剑士
							* 鬼剑士是本阶段的测试英雄。
							* 动画组成
								* 鬼剑士拥有三个动画部分，按顺序为：武器A、身体、武器B。
								* 身体部分将作为被攻击的碰撞盒，武器A和武器B则作为攻击时的碰撞盒。
								* 之所以要分为两个武器部分，是因为需要素材限制。
							* 技能设定
								* 本阶段所测试的技能只有一个：普通攻击。